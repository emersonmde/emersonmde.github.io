{"componentChunkName":"component---src-templates-blog-post-js","path":"/plausible-analytics/","result":{"data":{"site":{"siteMetadata":{"title":"Error Signal"}},"markdownRemark":{"id":"718d45ee-875b-584e-ae17-0d533295a510","excerpt":"I'm a strong believer in Robert Heinlein's quote, \"When one teaches, two\nlearn.\" To that end, my primary motivation to write these posts was to\nreinforce my own…","html":"<p>I'm a strong believer in Robert Heinlein's quote, \"When one teaches, two\nlearn.\" To that end, my primary motivation to write these posts was to\nreinforce my own understanding of the topics I touch on in my personal\nprojects. However, I still hope to provide value to others who may be\nexploring these topics for the first time. While the first goal is mostly\nsubjective, the second is more easily measured.</p>\n<h1>The World of Analytics</h1>\n<p>In my day job, analytics is often a crucial part of the software we build.\nMetrics and statistics are collected for just about anything measurable,\nfrom clicks, to API calls, to host metrics, and everything inbetween. Amazon\nhas a huge array of tools and services for collecting, storing, and analyzing\nmetrics. However, for my personal projects, I don't need anything nearly as\ncomplex, leaving aside the effort it would take to recreate similar tooling\nfor use externally.</p>\n<p>I was aware of services like Google Analytics that simplify the process of\ncollecting and analyzing metrics, but I haven't really explored them. I'm also\naware of the privacy concerns that come with using Google Analytics, but I\nwasn't sure of what alternatives were available. When I set out on this\njourney, one of the first videos I stumbled upon was\n<a href=\"https://www.youtube.com/watch?v=6xXSsu0YXWo\">a video</a> by\n<a href=\"https://www.youtube.com/@t3dotgg\">Theo - t3.gg</a> where he showcases two\nalternatives to Google Analytics: Plausible and PostHog. While PostHog is\nincredible powerful, it's overkill for my needs. Plausible is exactly what I\nwas looking for: a simple, open source, privacy-friendly alternative to\nGoogle Analytics.</p>\n<h1>Setting Up Plausible</h1>\n<p>Setting up Plausible can be incredibly simple. All you need to get started\nis an account and a script provided by Plausible that records events. Each\nnew account comes with a 30 day free trial with no up front payment details\nrequired. After the free trial the service costs £9/month for up to 10,000\npage views with the option of <a href=\"https://plausible.io/self-hosted-web-analytics\">self-hosting</a>\nfor free. In my case, another $12/month subscription wasn't ideal, but\nsomething I would gladly pay for a privacy focused alternative to the big\nplayers in the space.</p>\n<p>Since there is no credit card required to sign up,\n<a href=\"https://plausible.io/register\">creating an account</a> was straight forward.\nAfter signing up, you register your domain in their dashboard and are\npresented with a script tag to include in your website.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">defer</span> <span class=\"token attr-name\">data-domain</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>yourdomain.com<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://plausible.io/js/script.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Simply replacing your domain with the domain you registered with Plausible\nand including this script in the head of your website is all you need to start\ncollecting metrics.</p>\n<p>This works for most websites, however, thanks to the\nad blocker arms race, well known tracking scripts like this are usually\nblocked. Given my audience is likely to be more technically inclined, many of\nthe visitors to my site are likely to have an ad blocker installed reducing\nthe effectiveness of this approach. A primary reason I use an ad blocker is\nto protect against cross domain tracking from companies like Google and Meta,\nbut I'm not against website owners collecting metrics on their own site.\nThankfully Plausible has a <a href=\"https://plausible.io/docs/proxy/introduction\">guide on setting up a proxy</a>\nto bypass the simple matching logic used by most ad blockers. In this guide\nthey also provide a interesting breakdown of the privacy focused aspects of\nusing Plausible:</p>\n<blockquote>\n<p>Plausible is simply doing web analytics the way it was at the start before\nsurveillance capitalism became the default business model of the web:</p>\n<p>No cookies and other persistent identifiers.</p>\n<p>No connection to the adtech, and surveillance capitalism.</p>\n<p>No personal data is collected, and all stats are in aggregate only.</p>\n<p>No cross-site or cross-device tracking.</p>\n<p>You 100% own your website data, and it isn't sent to, shared with or sold to any third-parties.</p>\n<p>Open source web analytics software that can be self-hosted.</p>\n</blockquote>\n<p>It is easy to re-host the script from any static file host, but one of the\nprimary goals for <a href=\"../hello-gatsby\">creating this website using Gatsby and GitHub Pages</a>\nwas to avoid the need for an API. Nevertheless, I wanted to set up a proxy API\nin order to get some useful metrics out of Plausible. Fortunately I had\nalready set up an API using <a href=\"https://aws.amazon.com/api-gateway/\">API Gateway</a>\ndefined in <a href=\"https://aws.amazon.com/cdk/\">AWS's Cloud Development Kit (CDK)</a> for\na previous personal website. The biggest downside was I haven't touched it in\nover 2 years. After cutting through the deprecation messages and cobwebs it was\neasier than I expected to get the new endpoint working.</p>\n<h2>API Gateway Proxy</h2>\n<p>In Plausible's guide on <a href=\"https://plausible.io/docs/proxy/introduction\">setting up a proxy</a>,\nthey provide samples for many different hosting services but none for API\nGateway or CDK. The good news is this is only a few lines of code if you\nalready have a API Gateway defined in CDK.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> api <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">apigateway</span><span class=\"token punctuation\">.</span><span class=\"token function\">RestApi</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> apiResource <span class=\"token operator\">=</span> api<span class=\"token punctuation\">.</span>root<span class=\"token punctuation\">.</span><span class=\"token function\">addResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">'api'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> eventsResource <span class=\"token operator\">=</span> apiResource<span class=\"token punctuation\">.</span><span class=\"token function\">addResource</span><span class=\"token punctuation\">(</span><span class=\"token string\">'event'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> plausibleIntegration <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">apigateway</span><span class=\"token punctuation\">.</span><span class=\"token function\">HttpIntegration</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://plausible.io/api/event'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  httpMethod<span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n  proxy<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\neventsResource<span class=\"token punctuation\">.</span><span class=\"token function\">addMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span> plausibleIntegration<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>After deploying with <code class=\"language-text\">cdk deploy ApiStack</code>, the new endpoint was configured\nto proxy requests to <code class=\"language-text\">https://plausible.io/api/event</code>. Setting <code class=\"language-text\">proxy: true</code>\nensures that the request is passed through to the target without modification.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37c7e632ec9fd682b07e5639d1afe8b7/defc9/apig_screenshot.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABEElEQVR42mVRWW6FMAzkIF0hCVkJSYBHn54qtfe/09QOS4v6MVKcscdju3FDxlhu8LEgjBPytCLPK1xIeHoVFc9v8vJ+eVeIqVDugjLfoKyn+oTeBjQ+RtgwQDtfoYyF1Aai1xW9dVAUjzlTXkCrenSEgxe9ucTNtCxIuYCFh5G7WLRS1SQWjyRkvCf3EZpiQdwptov/RSOJaKU8PxQ5OlxJvRVtAju3T8H8lrNNo/eaxg0Ry8e9BoIT0wQ5pOrycMoFtTCMkDGjMw6tkCfPpvI01UlohyM+v75Ph7+70dfR2AUtXtMxlA8XnoV5dZb+m07tXWg8yQ7zXF2ywNGkcnyYZUW5P0hw+Ofe0WGVMfgB/ljPF95Wx98AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Plausible proxy setup in API Gateway\"\n        title=\" \"\n        src=\"/static/37c7e632ec9fd682b07e5639d1afe8b7/f058b/apig_screenshot.png\"\n        srcset=\"/static/37c7e632ec9fd682b07e5639d1afe8b7/c26ae/apig_screenshot.png 158w,\n/static/37c7e632ec9fd682b07e5639d1afe8b7/6bdcf/apig_screenshot.png 315w,\n/static/37c7e632ec9fd682b07e5639d1afe8b7/f058b/apig_screenshot.png 630w,\n/static/37c7e632ec9fd682b07e5639d1afe8b7/40601/apig_screenshot.png 945w,\n/static/37c7e632ec9fd682b07e5639d1afe8b7/78612/apig_screenshot.png 1260w,\n/static/37c7e632ec9fd682b07e5639d1afe8b7/defc9/apig_screenshot.png 2046w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"> </figcaption>\n  </figure></p>\n<p>After setting up the proxy API, the <a href=\"https://plausible.io/js/script.js\">event script</a>\ncan be downloaded and hosted in with the rest of the static files. Just make\nsure you don't name it <code class=\"language-text\">plausible.js</code> as your ad blocker will helpfully\nblock anything that with that keyword.</p>\n<p>Once the proxy and self hosted script are in place, the script tag can be\nupdated with the new values.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">defer</span> <span class=\"token attr-name\">data-api</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>your-event-proxy-url.com/api/event<span class=\"token punctuation\">\"</span></span> \n        <span class=\"token attr-name\">data-domain</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>your-domain.com<span class=\"token punctuation\">\"</span></span> \n        <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/js/totally-not-tracking-script.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2>Referral Metrics</h2>\n<p>One of the metrics I was interested in seeing was to see how many people\nfollowed the link from my blog to my older site which mainly hosts my\nphotography. When I first set up Plausible, I noticed all the sources\nwere \"None/Direct\". In order to provide a more useful source, Plausible\nsupports using a <code class=\"language-text\">ref</code> query parameter that can be set on any shared links.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://your-domain.com?ref=blog<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_blank<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>noopener<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Link<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>With this in place, metrics from both of my domains are now being flowing in\nwith the correct referral source despite using an ad blocker.</p>\n<h1>Profit</h1>\n<p>So what do you get after all of this? Plausible provides a dashboard to view\naggregated user metrics. The data updates in near real time and allows you\nto break down many of the metrics by time, device, source, and more. There\nare ways to add custom metrics and additional graphs, but the default\ndashboard works just fine for my needs.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/1078c/plausible_visitor_graph.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.30379746835443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPUlEQVR42pWS227CMAyGeY5tQE9pk7a0KbShUGAH0Ji0+73/m/yzXVqNSrvgwnISx1/+2J5F+RFxdUGY7ZEULdLqgMA0MHaHjNZRtsWqPiG1HaJ8C+veKF7DUMwdr9Blh2W8FluoCjMv2WAwX9fwNPsGvnF0VstZmLoxHqZbzKNKHjKWHr/FeM9CZgN9fCUqoasvFO0PVP4q+4Va36kY/Dyy456h7CfASlTp6gqz+UZcnCnBjgAvWYtNRdx9eQr0tYO2nwJLynN/rqgkscOTZ/Hs2QeAqgfG5QeCrCPo+y3WwhQXvHgNARu69wAwMC0VvqOvOerqSUog9Qr/VzYBbiSJbSndOohnFb7mzu1uU1D/sX4qhobcAVW+k29GGStr+zWNAl/g8VH5XtSqFammWEBjwzkcD+VeD+c1N/AXQhQMY2EjRvkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Plausible view metrics dashboard\"\n        title=\" \"\n        src=\"/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/f058b/plausible_visitor_graph.png\"\n        srcset=\"/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/c26ae/plausible_visitor_graph.png 158w,\n/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/6bdcf/plausible_visitor_graph.png 315w,\n/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/f058b/plausible_visitor_graph.png 630w,\n/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/40601/plausible_visitor_graph.png 945w,\n/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/78612/plausible_visitor_graph.png 1260w,\n/static/ce17d6dcc1d3c1420fd2baae2fdf6c31/1078c/plausible_visitor_graph.png 2180w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"> </figcaption>\n  </figure></p>\n<p>In addition to the overall view metrics graph, the dashboard also includes\ngraphs for Top Sources, Top Pages, Locations, and Devices.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fce5d0611211c1a245213c71945fcf41/5e485/plausible_other_graphs.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.48101265822784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACpElEQVR42o2Uy08TURTG538wRko703Y603Ye7XSmU/qYPoDSYhEwWJBQMQbxAcFHiBKDBjcuBKwrdm5cu1BMJGpca+JKN/r3fJx7gZISXovfzM2553z33nO/GUG3i4hbBQTk5BESkFQXsUQO4bgD1czCSJcRiFhdyGYFst4HRXcRpVyhOtbCcHMelZEbKDdmjtCC6Q4gqFpwSw0MjM6iUJuCV7/eRYlyba8BxchA8OpTqE3MoXKFBEdaXbCY7vTDF9TB8ibnVzDWWsL47MMOY60HmLi1jALNsx0LopLiA/Y+jmDUofkk4nYJ6eIIktkarFy9i1R+GJpdphbZEFjBWUgqLRo2ufBJHCx+TkGLE4q5RPpE9gXZ4BBJdTjdsRQkxaKxe2oeQxBpuyyZFxFRsw8q3ZaoWIdEEmQjo5PHjhfRmKWy+3UUV5I8VwipJkKKgd5gDJcCCvyhOCQqFpmArCMY0al/MYjhOKGhV4py/JQfoBgfUw1bVJQ1CKbbj2jSox44MJ0SN7BEW1dMjwydRiyZRyhqI5UdgFu8jIiRg5oodFDMPBnag5au7hnbHzZwwadg7s4ifnzdxuLSI/SEEpDjLpzcIC6KBnokDVa2iuLwNHLVa8gPNTsUapP0pRV5O2SNjG0WJrD6agvvtjbQbm/ianMGk9M38WZzAzufP+Btu41MYRA9QY377DivsviBI4Sw7mHhyWu83/6N8tA4iv0NfPvyEf///sK/Pz+x+vwF7TZNhcmONU5DEGUT/oiD5u01EhzF/N0FfN/5hLW1l1h5tsqP4QsZ/Hves8YZgsysPupZJlfGxvo6/7s8Xn4Kv2xhsD6Oe/eXuB2YLc4lyB6sD1rKg5WpoDecIDE6HsXDdPMa/drkuL3nQ+rVgV8PsbsEdwHEVwV9FZ4a5gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Plausible additional graphs\"\n        title=\" \"\n        src=\"/static/fce5d0611211c1a245213c71945fcf41/f058b/plausible_other_graphs.png\"\n        srcset=\"/static/fce5d0611211c1a245213c71945fcf41/c26ae/plausible_other_graphs.png 158w,\n/static/fce5d0611211c1a245213c71945fcf41/6bdcf/plausible_other_graphs.png 315w,\n/static/fce5d0611211c1a245213c71945fcf41/f058b/plausible_other_graphs.png 630w,\n/static/fce5d0611211c1a245213c71945fcf41/40601/plausible_other_graphs.png 945w,\n/static/fce5d0611211c1a245213c71945fcf41/78612/plausible_other_graphs.png 1260w,\n/static/fce5d0611211c1a245213c71945fcf41/5e485/plausible_other_graphs.png 2168w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"> </figcaption>\n  </figure></p>\n<p>Overall I've been extremely pleased with how simple this process was along with\nthe great documentation which had an answer for most of the problems I faced.\nIt remains to be seen if I will end up getting $12/month of value out of the\nservice and start paying for it full time, but I cannot recommend it enough if\nyou need a simple privacy focused analytics solution.</p>","frontmatter":{"title":"Plausible Analytics","date":"February 11, 2024","description":"Plausible is a simple, open source, privacy-friendly alternative to Google Analytics."}},"previous":{"fields":{"slug":"/1-billion-row-challenge-part-1/"},"frontmatter":{"title":"The 1 Billion Row Challenge - Part 1"}},"next":null},"pageContext":{"id":"718d45ee-875b-584e-ae17-0d533295a510","previousPostId":"2871f3ca-913e-55df-b40f-36c8b90aba64","nextPostId":null}},"staticQueryHashes":["2841359383","3274528899"],"slicesMap":{}}